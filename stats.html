<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Statistical functions for portfolio analysis">

<title>hypersheets - Stats</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="hypersheets - Stats">
<meta property="og:description" content="Statistical functions for portfolio analysis">
<meta property="og:site-name" content="hypersheets">
<meta name="twitter:title" content="hypersheets - Stats">
<meta name="twitter:description" content="Statistical functions for portfolio analysis">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">hypersheets</span>
    </a>
  </div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Stats</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">hypersheets</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./utils.html" class="sidebar-item-text sidebar-link">Utils</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stats.html" class="sidebar-item-text sidebar-link active">Stats</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./core_plots.html" class="sidebar-item-text sidebar-link">Core Plots</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./plots.html" class="sidebar-item-text sidebar-link">Plotting Function</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reports.html" class="sidebar-item-text sidebar-link">Reports</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#compsum" id="toc-compsum" class="nav-link active" data-scroll-target="#compsum">compsum</a></li>
  <li><a href="#comp" id="toc-comp" class="nav-link" data-scroll-target="#comp">comp</a></li>
  <li><a href="#distribution" id="toc-distribution" class="nav-link" data-scroll-target="#distribution">distribution</a></li>
  <li><a href="#expected_return" id="toc-expected_return" class="nav-link" data-scroll-target="#expected_return">expected_return</a></li>
  <li><a href="#ghpr" id="toc-ghpr" class="nav-link" data-scroll-target="#ghpr">ghpr</a></li>
  <li><a href="#geometric_mean" id="toc-geometric_mean" class="nav-link" data-scroll-target="#geometric_mean">geometric_mean</a></li>
  <li><a href="#outliers" id="toc-outliers" class="nav-link" data-scroll-target="#outliers">outliers</a></li>
  <li><a href="#remove_outliers" id="toc-remove_outliers" class="nav-link" data-scroll-target="#remove_outliers">remove_outliers</a></li>
  <li><a href="#best" id="toc-best" class="nav-link" data-scroll-target="#best">best</a></li>
  <li><a href="#worst" id="toc-worst" class="nav-link" data-scroll-target="#worst">worst</a></li>
  <li><a href="#consecutive_wins" id="toc-consecutive_wins" class="nav-link" data-scroll-target="#consecutive_wins">consecutive_wins</a></li>
  <li><a href="#consecutive_losses" id="toc-consecutive_losses" class="nav-link" data-scroll-target="#consecutive_losses">consecutive_losses</a></li>
  <li><a href="#exposure" id="toc-exposure" class="nav-link" data-scroll-target="#exposure">exposure</a></li>
  <li><a href="#win_rate" id="toc-win_rate" class="nav-link" data-scroll-target="#win_rate">win_rate</a></li>
  <li><a href="#avg_return" id="toc-avg_return" class="nav-link" data-scroll-target="#avg_return">avg_return</a></li>
  <li><a href="#avg_win" id="toc-avg_win" class="nav-link" data-scroll-target="#avg_win">avg_win</a></li>
  <li><a href="#avg_loss" id="toc-avg_loss" class="nav-link" data-scroll-target="#avg_loss">avg_loss</a></li>
  <li><a href="#volatility" id="toc-volatility" class="nav-link" data-scroll-target="#volatility">volatility</a></li>
  <li><a href="#rolling_volatility" id="toc-rolling_volatility" class="nav-link" data-scroll-target="#rolling_volatility">rolling_volatility</a></li>
  <li><a href="#implied_volatility" id="toc-implied_volatility" class="nav-link" data-scroll-target="#implied_volatility">implied_volatility</a></li>
  <li><a href="#autocorr_penalty" id="toc-autocorr_penalty" class="nav-link" data-scroll-target="#autocorr_penalty">autocorr_penalty</a></li>
  <li><a href="#sharpe" id="toc-sharpe" class="nav-link" data-scroll-target="#sharpe">sharpe</a></li>
  <li><a href="#smart_sharpe" id="toc-smart_sharpe" class="nav-link" data-scroll-target="#smart_sharpe">smart_sharpe</a></li>
  <li><a href="#rolling_sharpe" id="toc-rolling_sharpe" class="nav-link" data-scroll-target="#rolling_sharpe">rolling_sharpe</a></li>
  <li><a href="#sortino" id="toc-sortino" class="nav-link" data-scroll-target="#sortino">sortino</a></li>
  <li><a href="#smart_sortino" id="toc-smart_sortino" class="nav-link" data-scroll-target="#smart_sortino">smart_sortino</a></li>
  <li><a href="#rolling_sortino" id="toc-rolling_sortino" class="nav-link" data-scroll-target="#rolling_sortino">rolling_sortino</a></li>
  <li><a href="#skew" id="toc-skew" class="nav-link" data-scroll-target="#skew">skew</a></li>
  <li><a href="#kurtosis" id="toc-kurtosis" class="nav-link" data-scroll-target="#kurtosis">kurtosis</a></li>
  <li><a href="#probabilistic_ratio" id="toc-probabilistic_ratio" class="nav-link" data-scroll-target="#probabilistic_ratio">probabilistic_ratio</a></li>
  <li><a href="#probabilistic_sharpe_ratio" id="toc-probabilistic_sharpe_ratio" class="nav-link" data-scroll-target="#probabilistic_sharpe_ratio">probabilistic_sharpe_ratio</a></li>
  <li><a href="#probabilistic_sortino_ratio" id="toc-probabilistic_sortino_ratio" class="nav-link" data-scroll-target="#probabilistic_sortino_ratio">probabilistic_sortino_ratio</a></li>
  <li><a href="#probabilistic_adjusted_sortino_ratio" id="toc-probabilistic_adjusted_sortino_ratio" class="nav-link" data-scroll-target="#probabilistic_adjusted_sortino_ratio">probabilistic_adjusted_sortino_ratio</a></li>
  <li><a href="#omega" id="toc-omega" class="nav-link" data-scroll-target="#omega">omega</a></li>
  <li><a href="#gain_to_pain_ratio" id="toc-gain_to_pain_ratio" class="nav-link" data-scroll-target="#gain_to_pain_ratio">gain_to_pain_ratio</a></li>
  <li><a href="#cagr" id="toc-cagr" class="nav-link" data-scroll-target="#cagr">cagr</a></li>
  <li><a href="#rar" id="toc-rar" class="nav-link" data-scroll-target="#rar">rar</a></li>
  <li><a href="#max_drawdown" id="toc-max_drawdown" class="nav-link" data-scroll-target="#max_drawdown">max_drawdown</a></li>
  <li><a href="#to_drawdown_series" id="toc-to_drawdown_series" class="nav-link" data-scroll-target="#to_drawdown_series">to_drawdown_series</a></li>
  <li><a href="#calmar" id="toc-calmar" class="nav-link" data-scroll-target="#calmar">calmar</a></li>
  <li><a href="#ulcer_index" id="toc-ulcer_index" class="nav-link" data-scroll-target="#ulcer_index">ulcer_index</a></li>
  <li><a href="#ulcer_performance_index" id="toc-ulcer_performance_index" class="nav-link" data-scroll-target="#ulcer_performance_index">ulcer_performance_index</a></li>
  <li><a href="#upi" id="toc-upi" class="nav-link" data-scroll-target="#upi">upi</a></li>
  <li><a href="#risk_of_ruin" id="toc-risk_of_ruin" class="nav-link" data-scroll-target="#risk_of_ruin">risk_of_ruin</a></li>
  <li><a href="#ror" id="toc-ror" class="nav-link" data-scroll-target="#ror">ror</a></li>
  <li><a href="#value_at_risk" id="toc-value_at_risk" class="nav-link" data-scroll-target="#value_at_risk">value_at_risk</a></li>
  <li><a href="#var" id="toc-var" class="nav-link" data-scroll-target="#var">var</a></li>
  <li><a href="#conditional_value_at_risk" id="toc-conditional_value_at_risk" class="nav-link" data-scroll-target="#conditional_value_at_risk">conditional_value_at_risk</a></li>
  <li><a href="#cvar" id="toc-cvar" class="nav-link" data-scroll-target="#cvar">cvar</a></li>
  <li><a href="#expected_shortfall" id="toc-expected_shortfall" class="nav-link" data-scroll-target="#expected_shortfall">expected_shortfall</a></li>
  <li><a href="#serenity_index" id="toc-serenity_index" class="nav-link" data-scroll-target="#serenity_index">serenity_index</a></li>
  <li><a href="#tail_ratio" id="toc-tail_ratio" class="nav-link" data-scroll-target="#tail_ratio">tail_ratio</a></li>
  <li><a href="#payoff_ratio" id="toc-payoff_ratio" class="nav-link" data-scroll-target="#payoff_ratio">payoff_ratio</a></li>
  <li><a href="#win_loss_ratio" id="toc-win_loss_ratio" class="nav-link" data-scroll-target="#win_loss_ratio">win_loss_ratio</a></li>
  <li><a href="#profit_ratio" id="toc-profit_ratio" class="nav-link" data-scroll-target="#profit_ratio">profit_ratio</a></li>
  <li><a href="#profit_factor" id="toc-profit_factor" class="nav-link" data-scroll-target="#profit_factor">profit_factor</a></li>
  <li><a href="#cpc_index" id="toc-cpc_index" class="nav-link" data-scroll-target="#cpc_index">cpc_index</a></li>
  <li><a href="#common_sense_ratio" id="toc-common_sense_ratio" class="nav-link" data-scroll-target="#common_sense_ratio">common_sense_ratio</a></li>
  <li><a href="#outlier_win_ratio" id="toc-outlier_win_ratio" class="nav-link" data-scroll-target="#outlier_win_ratio">outlier_win_ratio</a></li>
  <li><a href="#outlier_loss_ratio" id="toc-outlier_loss_ratio" class="nav-link" data-scroll-target="#outlier_loss_ratio">outlier_loss_ratio</a></li>
  <li><a href="#recovery_factor" id="toc-recovery_factor" class="nav-link" data-scroll-target="#recovery_factor">recovery_factor</a></li>
  <li><a href="#risk_return_ratio" id="toc-risk_return_ratio" class="nav-link" data-scroll-target="#risk_return_ratio">risk_return_ratio</a></li>
  <li><a href="#drawdown_details" id="toc-drawdown_details" class="nav-link" data-scroll-target="#drawdown_details">drawdown_details</a></li>
  <li><a href="#kelly_criterion" id="toc-kelly_criterion" class="nav-link" data-scroll-target="#kelly_criterion">kelly_criterion</a></li>
  <li><a href="#comparing-against-a-benchmark" id="toc-comparing-against-a-benchmark" class="nav-link" data-scroll-target="#comparing-against-a-benchmark">Comparing against a benchmark</a>
  <ul class="collapse">
  <li><a href="#r_squared" id="toc-r_squared" class="nav-link" data-scroll-target="#r_squared">r_squared</a></li>
  <li><a href="#r2" id="toc-r2" class="nav-link" data-scroll-target="#r2">r2</a></li>
  <li><a href="#information_ratio" id="toc-information_ratio" class="nav-link" data-scroll-target="#information_ratio">information_ratio</a></li>
  <li><a href="#greeks" id="toc-greeks" class="nav-link" data-scroll-target="#greeks">greeks</a></li>
  <li><a href="#rolling_greeks" id="toc-rolling_greeks" class="nav-link" data-scroll-target="#rolling_greeks">rolling_greeks</a></li>
  <li><a href="#treynor_ratio" id="toc-treynor_ratio" class="nav-link" data-scroll-target="#treynor_ratio">treynor_ratio</a></li>
  <li><a href="#compare" id="toc-compare" class="nav-link" data-scroll-target="#compare">compare</a></li>
  <li><a href="#monthly_returns" id="toc-monthly_returns" class="nav-link" data-scroll-target="#monthly_returns">monthly_returns</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/KGrewal1/hypersheets/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Stats</h1>
</div>

<div>
  <div class="description">
    Statistical functions for portfolio analysis
  </div>
</div>


<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L31" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="compsum" class="level3">
<h3 class="anchored" data-anchor-id="compsum">compsum</h3>
<blockquote class="blockquote">
<pre><code> compsum (returns)</code></pre>
</blockquote>
<p>Calculates cumulative compounded returns up to each day, for series of daily returns</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>returns <span class="op">=</span> pd.Series(np.array([<span class="fl">0.03</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="op">-</span><span class="fl">0.01</span>, <span class="op">-</span><span class="fl">0.03</span>]))</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>compsum(returns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0    0.030000
1    0.040300
2    0.092315
3    0.081392
4    0.048950
dtype: float64</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L36" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="comp" class="level3">
<h3 class="anchored" data-anchor-id="comp">comp</h3>
<blockquote class="blockquote">
<pre><code> comp (returns)</code></pre>
</blockquote>
<p>Calculates total compounded return, for series of daily returns</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>returns <span class="op">=</span> pd.Series(np.array([<span class="fl">0.03</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="op">-</span><span class="fl">0.01</span>, <span class="op">-</span><span class="fl">0.03</span>]))</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>comp(returns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0.048950094500000096</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L41" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="distribution" class="level3">
<h3 class="anchored" data-anchor-id="distribution">distribution</h3>
<blockquote class="blockquote">
<pre><code> distribution (returns, compounded=True, prepare_returns=False)</code></pre>
</blockquote>
<p>Show the returns and outlier values based on IQR from a series of returns. Outliers are those more than 1.5 times the IQR from the Q1/Q3</p>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L79" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="expected_return" class="level3">
<h3 class="anchored" data-anchor-id="expected_return">expected_return</h3>
<blockquote class="blockquote">
<pre><code> expected_return (returns, aggregate=None, compounded=True,
                  prepare_returns=True)</code></pre>
</blockquote>
<p>Returns the expected geometric return for a given period by calculating the geometric holding period return</p>
<p>The expected geometric return is: <span class="math display">\[ \left(\prod\limits_{i=1}^{n}(p_{i})\right)^{(1/n)} -1\]</span></p>
<p>where <span class="math inline">\(p_{i}\)</span> is 1+ the daily return: <span class="math inline">\(p_{i}=\frac{v_{i}}{v_{i-1}}=1+r_{i}\)</span>, where <span class="math inline">\(v_{i}\)</span> and <span class="math inline">\(r_{i}\)</span> are value and return of the asset on day <span class="math inline">\(i\)</span> respectively</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>returns <span class="op">=</span> pd.Series(np.array([<span class="fl">0.03</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="op">-</span><span class="fl">0.01</span>, <span class="op">-</span><span class="fl">0.03</span>]))</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>expected_return(returns, aggregate<span class="op">=</span><span class="va">None</span>, compounded<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>                    prepare_returns<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0.009603773872040255</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L96" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="ghpr" class="level3">
<h3 class="anchored" data-anchor-id="ghpr">ghpr</h3>
<blockquote class="blockquote">
<pre><code> ghpr (retruns, aggregate=None, compounded=True)</code></pre>
</blockquote>
<p>Shorthand for expected_return()</p>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L91" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="geometric_mean" class="level3">
<h3 class="anchored" data-anchor-id="geometric_mean">geometric_mean</h3>
<blockquote class="blockquote">
<pre><code> geometric_mean (retruns, aggregate=None, compounded=True)</code></pre>
</blockquote>
<p>Shorthand for expected_return()</p>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L101" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="outliers" class="level3">
<h3 class="anchored" data-anchor-id="outliers">outliers</h3>
<blockquote class="blockquote">
<pre><code> outliers (returns, quantile=0.95)</code></pre>
</blockquote>
<p>Returns series of outliers: all values greater than the quantile</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>returns <span class="op">=</span> pd.Series(np.arange(<span class="dv">1</span>, <span class="dv">101</span>, <span class="dv">1</span>))</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>outliers(returns, quantile<span class="op">=</span><span class="fl">.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>95     96
96     97
97     98
98     99
99    100
dtype: int32</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L106" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="remove_outliers" class="level3">
<h3 class="anchored" data-anchor-id="remove_outliers">remove_outliers</h3>
<blockquote class="blockquote">
<pre><code> remove_outliers (returns, quantile=0.95)</code></pre>
</blockquote>
<p>Returns series of returns without the outliers on the top end</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>returns <span class="op">=</span> pd.Series(np.arange(<span class="dv">1</span>, <span class="dv">101</span>, <span class="dv">1</span>))</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>remove_outliers(returns, quantile<span class="op">=</span><span class="fl">.95</span>).tail(<span class="dv">10</span>) <span class="co"># the range goes from [1,100] to [1,95]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>85    86
86    87
87    88
88    89
89    90
90    91
91    92
92    93
93    94
94    95
dtype: int32</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L111" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="best" class="level3">
<h3 class="anchored" data-anchor-id="best">best</h3>
<blockquote class="blockquote">
<pre><code> best (returns, aggregate=None, compounded=True, prepare_returns=False)</code></pre>
</blockquote>
<p>Returns the best day/month/week/quarter/year’s return</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>returns <span class="op">=</span> _utils.download_returns(<span class="st">'SPY'</span>, <span class="st">'5y'</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>best(returns)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co">#best(returns)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0.09060315805687602</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L118" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="worst" class="level3">
<h3 class="anchored" data-anchor-id="worst">worst</h3>
<blockquote class="blockquote">
<pre><code> worst (returns, aggregate=None, compounded=True, prepare_returns=False)</code></pre>
</blockquote>
<p>Returns the worst day/month/week/quarter/year’s return</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>returns <span class="op">=</span> _utils.download_returns(<span class="st">'SPY'</span>, <span class="st">'5y'</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>worst(returns)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co">#best(returns)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>-0.10942352331745997</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L125" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="consecutive_wins" class="level3">
<h3 class="anchored" data-anchor-id="consecutive_wins">consecutive_wins</h3>
<blockquote class="blockquote">
<pre><code> consecutive_wins (returns, aggregate=None, compounded=True,
                   prepare_returns=False)</code></pre>
</blockquote>
<p>Returns the maximum consecutive wins by day/month/week/quarter/year</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>returns <span class="op">=</span> _utils.download_returns(<span class="st">'SPY'</span>, <span class="st">'5y'</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>consecutive_wins(returns)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="co">#best(returns)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>11</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L134" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="consecutive_losses" class="level3">
<h3 class="anchored" data-anchor-id="consecutive_losses">consecutive_losses</h3>
<blockquote class="blockquote">
<pre><code> consecutive_losses (returns, aggregate=None, compounded=True,
                     prepare_returns=False)</code></pre>
</blockquote>
<p>Returns the maximum consecutive losses by day/month/week/quarter/year</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>returns <span class="op">=</span> _utils.download_returns(<span class="st">'SPY'</span>, <span class="st">'5y'</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>consecutive_losses(returns)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co">#best(returns)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>8</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L152" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="exposure" class="level3">
<h3 class="anchored" data-anchor-id="exposure">exposure</h3>
<blockquote class="blockquote">
<pre><code> exposure (returns, prepare_returns=False)</code></pre>
</blockquote>
<p>Returns the market exposure time (returns != 0)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>returns <span class="op">=</span> _utils.download_returns(<span class="st">'SPY'</span>, <span class="st">'5y'</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>exposure(returns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>1.0</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L174" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="win_rate" class="level3">
<h3 class="anchored" data-anchor-id="win_rate">win_rate</h3>
<blockquote class="blockquote">
<pre><code> win_rate (returns, aggregate=None, compounded=True,
           prepare_returns=False)</code></pre>
</blockquote>
<p>Calculates the win ratio for a period: (number of winning days)/(number of days in market)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>returns <span class="op">=</span> _utils.download_returns(<span class="st">'SPY'</span>, <span class="st">'5y'</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>win_rate(returns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0.5542264752791068</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L192" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="avg_return" class="level3">
<h3 class="anchored" data-anchor-id="avg_return">avg_return</h3>
<blockquote class="blockquote">
<pre><code> avg_return (returns, aggregate=None, compounded=True,
             prepare_returns=False)</code></pre>
</blockquote>
<p>Calculates the average return/trade return for a period</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>returns <span class="op">=</span> _utils.download_returns(<span class="st">'SPY'</span>, <span class="st">'5y'</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>avg_return(returns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0.0004451419089322777</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L202" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="avg_win" class="level3">
<h3 class="anchored" data-anchor-id="avg_win">avg_win</h3>
<blockquote class="blockquote">
<pre><code> avg_win (returns, aggregate=None, compounded=True, prepare_returns=False)</code></pre>
</blockquote>
<p>Calculates the average winning return/trade return for a period</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>returns <span class="op">=</span> _utils.download_returns(<span class="st">'SPY'</span>, <span class="st">'5y'</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>avg_win(returns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0.008044224938256789</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L214" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="avg_loss" class="level3">
<h3 class="anchored" data-anchor-id="avg_loss">avg_loss</h3>
<blockquote class="blockquote">
<pre><code> avg_loss (returns, aggregate=None, compounded=True,
           prepare_returns=False)</code></pre>
</blockquote>
<p>Calculates the average low if return/trade return for a period</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>returns <span class="op">=</span> _utils.download_returns(<span class="st">'SPY'</span>, <span class="st">'5y'</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>avg_loss(returns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>-0.009002736188760357</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L226" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="volatility" class="level3">
<h3 class="anchored" data-anchor-id="volatility">volatility</h3>
<blockquote class="blockquote">
<pre><code> volatility (returns, periods=252, annualize=True, prepare_returns=False)</code></pre>
</blockquote>
<p>Calculates the volatility of returns for a period</p>
<p>Calculate volatility as <span class="math inline">\(\text{vol.}=\sigma\sqrt{T}\)</span> where <span class="math inline">\(\sigma\)</span> is the standard deviations of returns and <span class="math inline">\(T\)</span> the number of periods in the time horizon</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>returns <span class="op">=</span> _utils.download_returns(<span class="st">'SPY'</span>, <span class="st">'5y'</span>)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>volatility(returns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0.20844063908238844</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L237" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="rolling_volatility" class="level3">
<h3 class="anchored" data-anchor-id="rolling_volatility">rolling_volatility</h3>
<blockquote class="blockquote">
<pre><code> rolling_volatility (returns, rolling_period=126, periods_per_year=252,
                     prepare_returns=False)</code></pre>
</blockquote>
<p>Create time series of rolling volatility</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>returns <span class="op">=</span> _utils.download_returns(<span class="st">'SPY'</span>, <span class="st">'1y'</span>)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>rolling_volatility(returns).tail(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Date
2022-09-16    0.248680
2022-09-19    0.248414
2022-09-20    0.248865
2022-09-21    0.249286
2022-09-22    0.248944
2022-09-23    0.248828
2022-09-26    0.248951
2022-09-27    0.248649
2022-09-28    0.249690
2022-09-29    0.251102
Name: Close, dtype: float64</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L246" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="implied_volatility" class="level3">
<h3 class="anchored" data-anchor-id="implied_volatility">implied_volatility</h3>
<blockquote class="blockquote">
<pre><code> implied_volatility (returns, periods=252, annualize=False)</code></pre>
</blockquote>
<p>Calculates the implied volatility of returns for a period</p>
<p>Implied volatility is defined here as the standard deviation of the log returns. This works under the assumption that returns are lognormally distributed and so the log of returns is a normal distribution.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>returns <span class="op">=</span> _utils.download_returns(<span class="st">'SPY'</span>, <span class="st">'1y'</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>implied_volatility(returns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0.013801893088772903</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L255" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="autocorr_penalty" class="level3">
<h3 class="anchored" data-anchor-id="autocorr_penalty">autocorr_penalty</h3>
<blockquote class="blockquote">
<pre><code> autocorr_penalty (returns, prepare_returns=False)</code></pre>
</blockquote>
<p>Metric to account for auto correlation</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>returns <span class="op">=</span> _utils.download_returns(<span class="st">'SPY'</span>, <span class="st">'5y'</span>)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>autocorr_penalty(returns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>1.1893156409496177</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L272" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="sharpe" class="level3">
<h3 class="anchored" data-anchor-id="sharpe">sharpe</h3>
<blockquote class="blockquote">
<pre><code> sharpe (returns, rf=0.0, periods=252, annualize=True, smart=False,
         prepare_returns=False)</code></pre>
</blockquote>
<p>Calculates the sharpe ratio of access returns If rf is non-zero, you must specify periods. In this case, rf is assumed to be expressed in yearly (annualized) terms Args: * returns (Series, DataFrame): Input return series * rf (float): Risk-free rate expressed as a yearly (annualized) return * periods (int): Freq. of returns (252/365 for daily, 12 for monthly) * annualize: return annualize sharpe? * smart: return smart sharpe ratio</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>returns <span class="op">=</span> _utils.download_returns(<span class="st">'SPY'</span>, <span class="st">'5y'</span>)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>sharpe(returns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0.5364553566622334</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L303" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="smart_sharpe" class="level3">
<h3 class="anchored" data-anchor-id="smart_sharpe">smart_sharpe</h3>
<blockquote class="blockquote">
<pre><code> smart_sharpe (returns, rf=0.0, periods=252, annualize=True)</code></pre>
</blockquote>
<p>Sharpe ratio, penalised with autocorrelation penalty</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>returns <span class="op">=</span> _utils.download_returns(<span class="st">'SPY'</span>, <span class="st">'5y'</span>)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>smart_sharpe(returns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0.4510622023704182</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L308" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="rolling_sharpe" class="level3">
<h3 class="anchored" data-anchor-id="rolling_sharpe">rolling_sharpe</h3>
<blockquote class="blockquote">
<pre><code> rolling_sharpe (returns, rf=0.0, rolling_period=126, annualize=True,
                 periods_per_year=252, prepare_returns=False)</code></pre>
</blockquote>
<p>Calculate rolling Sharpe ratio over a period</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>returns <span class="op">=</span> _utils.download_returns(<span class="st">'SPY'</span>, <span class="st">'5y'</span>)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>rolling_sharpe(returns).tail(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Date
2022-09-16   -0.864632
2022-09-19   -0.891301
2022-09-20   -0.979586
2022-09-21   -1.211758
2022-09-22   -1.177445
2022-09-23   -1.433826
2022-09-26   -1.551825
2022-09-27   -1.631454
2022-09-28   -1.566138
2022-09-29   -1.674526
Name: Close, dtype: float64</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L331" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="sortino" class="level3">
<h3 class="anchored" data-anchor-id="sortino">sortino</h3>
<blockquote class="blockquote">
<pre><code> sortino (returns, rf=0, periods=252, annualize=True, smart=False,
          prepare_returns=False)</code></pre>
</blockquote>
<p>Calculates the sortino ratio of access returns If rf is non-zero, you must specify periods. In this case, rf is assumed to be expressed in yearly (annualized) terms Calculation is based on this paper by Red Rock Capital http://www.redrockcapital.com/Sortino__A__Sharper__Ratio_Red_Rock_Capital.pdf</p>
<p>Calculates Sortino ratio as <span class="math inline">\(\frac{\text{Expected Excess Return}}{\text{Downside Deviation}}\)</span> where for <span class="math inline">\(n\)</span> periods the Downside deviation is <span class="math inline">\(\sqrt{\frac{\sum d^{2}}{n}}\)</span> where <span class="math inline">\(d\)</span> is an excess return less than 0, and the expected excess return is the mean excess return, and annualised</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>returns <span class="op">=</span> _utils.download_returns(<span class="st">'SPY'</span>, <span class="st">'5y'</span>)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>sortino(returns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0.7310777239511432</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L363" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="smart_sortino" class="level3">
<h3 class="anchored" data-anchor-id="smart_sortino">smart_sortino</h3>
<blockquote class="blockquote">
<pre><code> smart_sortino (returns, rf=0, periods=252, annualize=True)</code></pre>
</blockquote>
<p>Calculates Smart Sortino ratio, adding an autocorrelation penalty</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>returns <span class="op">=</span> _utils.download_returns(<span class="st">'SPY'</span>, <span class="st">'5y'</span>)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>smart_sortino(returns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0.6147043287347095</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> adjusted_sortino(returns, rf<span class="op">=</span><span class="dv">0</span>, periods<span class="op">=</span><span class="dv">252</span>, annualize<span class="op">=</span><span class="va">True</span>, smart<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Jack Schwager's version of the Sortino ratio allows for</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="co">    direct comparisons to the Sharpe. See here for more info:</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a><span class="co">    https://archive.is/wip/2rwFW</span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> sortino(</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>        returns, rf, periods<span class="op">=</span>periods, annualize<span class="op">=</span>annualize, smart<span class="op">=</span>smart)</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> data <span class="op">/</span> sqrt(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The adjusted sortino is defined as <span class="math inline">\(\text{Adj. Sortino}=\text{Sortino}/\sqrt{2}\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>returns <span class="op">=</span> _utils.download_returns(<span class="st">'SPY'</span>, <span class="st">'5y'</span>)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>adjusted_sortino(returns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0.5169498730432484</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L368" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="rolling_sortino" class="level3">
<h3 class="anchored" data-anchor-id="rolling_sortino">rolling_sortino</h3>
<blockquote class="blockquote">
<pre><code> rolling_sortino (returns, rf=0, rolling_period=126, annualize=True,
                  periods_per_year=252, **kwargs)</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>returns <span class="op">=</span> _utils.download_returns(<span class="st">'SPY'</span>, <span class="st">'5y'</span>)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>rolling_sortino(returns).tail(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Date
2022-09-16   -1.119173
2022-09-19   -1.152463
2022-09-20   -1.264410
2022-09-21   -1.554069
2022-09-22   -1.511805
2022-09-23   -1.826545
2022-09-26   -1.972788
2022-09-27   -2.071153
2022-09-28   -1.996554
2022-09-29   -2.124861
Name: Close, dtype: float64</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L388" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="skew" class="level3">
<h3 class="anchored" data-anchor-id="skew">skew</h3>
<blockquote class="blockquote">
<pre><code> skew (returns, prepare_returns=False)</code></pre>
</blockquote>
<p>Calculates returns’ skewness (the degree of asymmetry of a distribution around its mean)</p>
<p>The skew is defined as <span class="math inline">\(\text{Skew}(X)=\frac{E[(X-\mu)^{3}]}{E[(X-\mu)^{2}]^{3/2}}=\frac{\mu_{3}}{\sigma^{3}}\)</span>, where <span class="math inline">\(\mu\)</span> is mean, <span class="math inline">\(\sigma\)</span> stadard deviation and <span class="math inline">\(\mu_{3}\)</span>, third moment of inertia.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>returns <span class="op">=</span> _utils.download_returns(<span class="st">'SPY'</span>, <span class="st">'5y'</span>)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>skew(returns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>-0.6567130752131589</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L398" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="kurtosis" class="level3">
<h3 class="anchored" data-anchor-id="kurtosis">kurtosis</h3>
<blockquote class="blockquote">
<pre><code> kurtosis (returns, prepare_returns=False)</code></pre>
</blockquote>
<p>Calculates returns’ kurtosis (the degree to which a distribution peak compared to a normal distribution)</p>
<p>The kurtosis is defined as <span class="math inline">\(\text{Kurt}(X)=\frac{E[(X-\mu)^{4}]}{E[(X-\mu)^{2}]^{2}}=\frac{\mu_{4}}{\sigma^{2}}\)</span>, where <span class="math inline">\(\mu\)</span> is mean, <span class="math inline">\(\sigma\)</span> stadard deviation and <span class="math inline">\(\mu_{4}\)</span>, fourth moment of inertia. A measure of ‘tailed’: higher kurtosis means fatter tails.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>returns <span class="op">=</span> _utils.download_returns(<span class="st">'SPY'</span>, <span class="st">'5y'</span>)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>kurtosis(returns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>11.996182480024226</code></pre>
</div>
</div>
<pre><code>&lt;AxesSubplot:ylabel='Frequency'&gt;</code></pre>
<p><img src="01_stats_files/figure-html/cell-59-output-2.png" class="img-fluid"></p>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L409" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="probabilistic_ratio" class="level3">
<h3 class="anchored" data-anchor-id="probabilistic_ratio">probabilistic_ratio</h3>
<blockquote class="blockquote">
<pre><code> probabilistic_ratio (series, rf=0.0, base='sharpe', periods=252,
                      annualize=False, smart=False)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L438" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="probabilistic_sharpe_ratio" class="level3">
<h3 class="anchored" data-anchor-id="probabilistic_sharpe_ratio">probabilistic_sharpe_ratio</h3>
<blockquote class="blockquote">
<pre><code> probabilistic_sharpe_ratio (series, rf=0.0, periods=252, annualize=False,
                             smart=False)</code></pre>
</blockquote>
<p>The probabilistic Sharpe Ratio</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>returns <span class="op">=</span> _utils.download_returns(<span class="st">'SPY'</span>, <span class="st">'5y'</span>)</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>probabilistic_sharpe_ratio(returns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0.8816407449051655</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L444" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="probabilistic_sortino_ratio" class="level3">
<h3 class="anchored" data-anchor-id="probabilistic_sortino_ratio">probabilistic_sortino_ratio</h3>
<blockquote class="blockquote">
<pre><code> probabilistic_sortino_ratio (series, rf=0.0, periods=252,
                              annualize=False, smart=False)</code></pre>
</blockquote>
<p>The probabilistic Sortino Ratio</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>returns <span class="op">=</span> _utils.download_returns(<span class="st">'SPY'</span>, <span class="st">'5y'</span>)</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>probabilistic_sortino_ratio(returns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0.9456555568118186</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L450" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="probabilistic_adjusted_sortino_ratio" class="level3">
<h3 class="anchored" data-anchor-id="probabilistic_adjusted_sortino_ratio">probabilistic_adjusted_sortino_ratio</h3>
<blockquote class="blockquote">
<pre><code> probabilistic_adjusted_sortino_ratio (series, rf=0.0, periods=252,
                                       annualize=False, smart=False)</code></pre>
</blockquote>
<p>The probabilistic adj. Sortino Ratio</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>returns <span class="op">=</span> _utils.download_returns(<span class="st">'SPY'</span>, <span class="st">'5y'</span>)</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>probabilistic_adjusted_sortino_ratio(returns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0.8730193107071486</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L456" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="omega" class="level3">
<h3 class="anchored" data-anchor-id="omega">omega</h3>
<blockquote class="blockquote">
<pre><code> omega (returns, rf=0.0, required_return=0.0, periods=252, **kwargs)</code></pre>
</blockquote>
<p>Determines the Omega ratio of a strategy. See https://en.wikipedia.org/wiki/Omega_ratio for more details.</p>
<p>This is broken</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>returns <span class="op">=</span> _utils.download_returns(<span class="st">'SPY'</span>, <span class="st">'5y'</span>)</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="co">#omega(returns, 0.01)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L489" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="gain_to_pain_ratio" class="level3">
<h3 class="anchored" data-anchor-id="gain_to_pain_ratio">gain_to_pain_ratio</h3>
<blockquote class="blockquote">
<pre><code> gain_to_pain_ratio (returns, rf=0, resolution='D', **kwargs)</code></pre>
</blockquote>
<p>Jack Schwager’s GPR. See here for more info: https://archive.is/wip/2rwFW</p>
<p>This seems to be wrong</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>returns <span class="op">=</span> _utils.download_returns(<span class="st">'SPY'</span>, <span class="st">'5y'</span>)</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>gain_to_pain_ratio(returns, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0.11091999229680034</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L502" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="cagr" class="level3">
<h3 class="anchored" data-anchor-id="cagr">cagr</h3>
<blockquote class="blockquote">
<pre><code> cagr (returns, rf=0.0, compounded=True, **kwargs)</code></pre>
</blockquote>
<p>Calculates the communicative annualized growth return (CAGR%) of access returns If rf is non-zero, you must specify periods?. In this case, rf is assumed to be expressed in yearly (annualized) terms</p>
<p>Check</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>returns <span class="op">=</span> _utils.download_returns(<span class="st">'SPY'</span>, <span class="st">'5y'</span>)</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>cagr(returns, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0.09407550605477089</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L528" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="rar" class="level3">
<h3 class="anchored" data-anchor-id="rar">rar</h3>
<blockquote class="blockquote">
<pre><code> rar (returns, rf=0.0, **kwargs)</code></pre>
</blockquote>
<p>Calculates the risk-adjusted return of access returns (CAGR / exposure. takes time into account.) If rf is non-zero, you must specify periods. In this case, rf is assumed to be expressed in yearly (annualized) terms</p>
<p>Check if this should be excess return</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>returns <span class="op">=</span> _utils.download_returns(<span class="st">'SPY'</span>, <span class="st">'5y'</span>)</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>rar(returns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0.09407549161897544</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L540" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="max_drawdown" class="level3">
<h3 class="anchored" data-anchor-id="max_drawdown">max_drawdown</h3>
<blockquote class="blockquote">
<pre><code> max_drawdown (returns)</code></pre>
</blockquote>
<p>Calculates the maximum drawdown</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>returns <span class="op">=</span> _utils.download_returns(<span class="st">'SPY'</span>, <span class="st">'5y'</span>)</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>max_drawdown(returns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>-0.3371726193896011</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L546" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="to_drawdown_series" class="level3">
<h3 class="anchored" data-anchor-id="to_drawdown_series">to_drawdown_series</h3>
<blockquote class="blockquote">
<pre><code> to_drawdown_series (returns)</code></pre>
</blockquote>
<p>Convert returns series to drawdown series</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>returns <span class="op">=</span> _utils.download_returns(<span class="st">'SPY'</span>, <span class="st">'5y'</span>)</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>to_drawdown_series(returns).tail(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Date
2022-09-16   -0.183555
2022-09-19   -0.177223
2022-09-20   -0.186668
2022-09-21   -0.200855
2022-09-22   -0.207568
2022-09-23   -0.220845
2022-09-26   -0.228553
2022-09-27   -0.230522
2022-09-28   -0.215382
2022-09-29   -0.231771
Name: Close, dtype: float64</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L553" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="calmar" class="level3">
<h3 class="anchored" data-anchor-id="calmar">calmar</h3>
<blockquote class="blockquote">
<pre><code> calmar (returns, prepare_returns=False)</code></pre>
</blockquote>
<p>Calculates the calmar ratio (CAGR% / MaxDD%)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>returns <span class="op">=</span> _utils.download_returns(<span class="st">'SPY'</span>, <span class="st">'5y'</span>)</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>calmar(returns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0.27901279782780064</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L562" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="ulcer_index" class="level3">
<h3 class="anchored" data-anchor-id="ulcer_index">ulcer_index</h3>
<blockquote class="blockquote">
<pre><code> ulcer_index (returns)</code></pre>
</blockquote>
<p>Calculates the ulcer index score (downside risk measurment)</p>
<p>Define properly</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>returns <span class="op">=</span> _utils.download_returns(<span class="st">'SPY'</span>, <span class="st">'5y'</span>)</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>ulcer_index(returns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0.07637641267955013</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L568" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="ulcer_performance_index" class="level3">
<h3 class="anchored" data-anchor-id="ulcer_performance_index">ulcer_performance_index</h3>
<blockquote class="blockquote">
<pre><code> ulcer_performance_index (returns, rf=0)</code></pre>
</blockquote>
<p>Calculates the ulcer index score (downside risk measurment)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>returns <span class="op">=</span> _utils.download_returns(<span class="st">'SPY'</span>, <span class="st">'5y'</span>)</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>ulcer_performance_index(returns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>7.4215621009669315</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L576" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="upi" class="level3">
<h3 class="anchored" data-anchor-id="upi">upi</h3>
<blockquote class="blockquote">
<pre><code> upi (returns, rf=0)</code></pre>
</blockquote>
<p>Shorthand for ulcer_performance_index()</p>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L581" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="risk_of_ruin" class="level3">
<h3 class="anchored" data-anchor-id="risk_of_ruin">risk_of_ruin</h3>
<blockquote class="blockquote">
<pre><code> risk_of_ruin (returns, prepare_returns=False)</code></pre>
</blockquote>
<p>Calculates the risk of ruin (the likelihood of losing all one’s investment capital)</p>
<p>Check definition</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>returns <span class="op">=</span> _utils.download_returns(<span class="st">'SPY'</span>, <span class="st">'5y'</span>)</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>risk_of_ruin(returns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0.0</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L592" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="ror" class="level3">
<h3 class="anchored" data-anchor-id="ror">ror</h3>
<blockquote class="blockquote">
<pre><code> ror (returns)</code></pre>
</blockquote>
<p>Shorthand for risk_of_ruin()</p>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L597" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="value_at_risk" class="level3">
<h3 class="anchored" data-anchor-id="value_at_risk">value_at_risk</h3>
<blockquote class="blockquote">
<pre><code> value_at_risk (returns, sigma=1, confidence=0.95, prepare_returns=False)</code></pre>
</blockquote>
<p>Calculats the daily value-at-risk (variance-covariance calculation with confidence n)</p>
<p>Define</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>returns <span class="op">=</span> _utils.download_returns(<span class="st">'SPY'</span>, <span class="st">'5y'</span>)</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>value_at_risk(returns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>-0.021154066958981442</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L613" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="var" class="level3">
<h3 class="anchored" data-anchor-id="var">var</h3>
<blockquote class="blockquote">
<pre><code> var (returns, sigma=1, confidence=0.95, prepare_returns=False)</code></pre>
</blockquote>
<p>Shorthand for value_at_risk()</p>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L618" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="conditional_value_at_risk" class="level3">
<h3 class="anchored" data-anchor-id="conditional_value_at_risk">conditional_value_at_risk</h3>
<blockquote class="blockquote">
<pre><code> conditional_value_at_risk (returns, sigma=1, confidence=0.95,
                            prepare_returns=False)</code></pre>
</blockquote>
<p>Calculats the conditional daily value-at-risk (aka expected shortfall) quantifies the amount of tail risk an investment</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>returns <span class="op">=</span> _utils.download_returns(<span class="st">'SPY'</span>, <span class="st">'5y'</span>)</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>conditional_value_at_risk(returns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>-0.03378474064120063</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L631" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="cvar" class="level3">
<h3 class="anchored" data-anchor-id="cvar">cvar</h3>
<blockquote class="blockquote">
<pre><code> cvar (returns, sigma=1, confidence=0.95, prepare_returns=False)</code></pre>
</blockquote>
<p>Shorthand for conditional_value_at_risk()</p>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L637" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="expected_shortfall" class="level3">
<h3 class="anchored" data-anchor-id="expected_shortfall">expected_shortfall</h3>
<blockquote class="blockquote">
<pre><code> expected_shortfall (returns, sigma=1, confidence=0.95,
                     prepare_returns=False)</code></pre>
</blockquote>
<p>Shorthand for conditional_value_at_risk()</p>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L642" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="serenity_index" class="level3">
<h3 class="anchored" data-anchor-id="serenity_index">serenity_index</h3>
<blockquote class="blockquote">
<pre><code> serenity_index (returns, rf=0)</code></pre>
</blockquote>
<p>Calculates the serenity index score (https://www.keyquant.com/Download/GetFile?Filename=%5CPublications%5CKeyQuant_WhitePaper_APT_Part1.pdf)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>returns <span class="op">=</span> _utils.download_returns(<span class="st">'SPY'</span>, <span class="st">'5y'</span>)</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>serenity_index(returns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0.5104927720686929</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L652" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="tail_ratio" class="level3">
<h3 class="anchored" data-anchor-id="tail_ratio">tail_ratio</h3>
<blockquote class="blockquote">
<pre><code> tail_ratio (returns, cutoff=0.95, prepare_returns=False)</code></pre>
</blockquote>
<p>Measures the ratio between the right (95%) and left tail (5%).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>returns <span class="op">=</span> _utils.download_returns(<span class="st">'SPY'</span>, <span class="st">'5y'</span>)</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>tail_ratio(returns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0.8246500295451326</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L662" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="payoff_ratio" class="level3">
<h3 class="anchored" data-anchor-id="payoff_ratio">payoff_ratio</h3>
<blockquote class="blockquote">
<pre><code> payoff_ratio (returns, prepare_returns=False)</code></pre>
</blockquote>
<p>Measures the payoff ratio (average win/average loss)</p>
<p>Should probably rate this by win rate/loss rate</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>returns <span class="op">=</span> _utils.download_returns(<span class="st">'SPY'</span>, <span class="st">'5y'</span>)</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>payoff_ratio(returns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0.8935312962081646</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L670" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="win_loss_ratio" class="level3">
<h3 class="anchored" data-anchor-id="win_loss_ratio">win_loss_ratio</h3>
<blockquote class="blockquote">
<pre><code> win_loss_ratio (returns, prepare_returns=False)</code></pre>
</blockquote>
<p>Shorthand for payoff_ratio()</p>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L675" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="profit_ratio" class="level3">
<h3 class="anchored" data-anchor-id="profit_ratio">profit_ratio</h3>
<blockquote class="blockquote">
<pre><code> profit_ratio (returns, prepare_returns=False)</code></pre>
</blockquote>
<p>Measures the profit ratio (win ratio / loss ratio)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>returns <span class="op">=</span> _utils.download_returns(<span class="st">'SPY'</span>, <span class="st">'5y'</span>)</span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>profit_ratio(returns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0.7104803267194572</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L690" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="profit_factor" class="level3">
<h3 class="anchored" data-anchor-id="profit_factor">profit_factor</h3>
<blockquote class="blockquote">
<pre><code> profit_factor (returns, prepare_returns=False)</code></pre>
</blockquote>
<p>Measures the profit ratio (wins/loss)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>returns <span class="op">=</span> _utils.download_returns(<span class="st">'SPY'</span>, <span class="st">'5y'</span>)</span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>profit_factor(returns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>1.1109199478795606</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L697" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="cpc_index" class="level3">
<h3 class="anchored" data-anchor-id="cpc_index">cpc_index</h3>
<blockquote class="blockquote">
<pre><code> cpc_index (returns, prepare_returns=False)</code></pre>
</blockquote>
<p>Measures the cpc ratio (profit factor * win % * win loss ratio)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>returns <span class="op">=</span> _utils.download_returns(<span class="st">'SPY'</span>, <span class="st">'5y'</span>)</span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>profit_factor(returns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>1.1109200029518147</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L707" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="common_sense_ratio" class="level3">
<h3 class="anchored" data-anchor-id="common_sense_ratio">common_sense_ratio</h3>
<blockquote class="blockquote">
<pre><code> common_sense_ratio (returns, prepare_returns=False)</code></pre>
</blockquote>
<p>Measures the common sense ratio (profit factor * tail ratio)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>returns <span class="op">=</span> _utils.download_returns(<span class="st">'SPY'</span>, <span class="st">'5y'</span>)</span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>common_sense_ratio(returns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0.9161143659778377</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L714" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="outlier_win_ratio" class="level3">
<h3 class="anchored" data-anchor-id="outlier_win_ratio">outlier_win_ratio</h3>
<blockquote class="blockquote">
<pre><code> outlier_win_ratio (returns, quantile=0.99, prepare_returns=False)</code></pre>
</blockquote>
<p>Calculates the outlier winners ratio 99th percentile of returns / mean positive return</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a>returns <span class="op">=</span> _utils.download_returns(<span class="st">'SPY'</span>, <span class="st">'5y'</span>)</span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>outlier_win_ratio(returns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>3.8800605330519113</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L724" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="outlier_loss_ratio" class="level3">
<h3 class="anchored" data-anchor-id="outlier_loss_ratio">outlier_loss_ratio</h3>
<blockquote class="blockquote">
<pre><code> outlier_loss_ratio (returns, quantile=0.01, prepare_returns=False)</code></pre>
</blockquote>
<p>Calculates the outlier losers ratio 1st percentile of returns / mean negative return</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>returns <span class="op">=</span> _utils.download_returns(<span class="st">'SPY'</span>, <span class="st">'5y'</span>)</span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a>outlier_loss_ratio(returns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>4.188328392594448</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L734" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="recovery_factor" class="level3">
<h3 class="anchored" data-anchor-id="recovery_factor">recovery_factor</h3>
<blockquote class="blockquote">
<pre><code> recovery_factor (returns, prepare_returns=False)</code></pre>
</blockquote>
<p>Measures how fast the strategy recovers from drawdowns</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>returns <span class="op">=</span> _utils.download_returns(<span class="st">'SPY'</span>, <span class="st">'5y'</span>)</span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>recovery_factor(returns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>1.6811327076863491</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L743" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="risk_return_ratio" class="level3">
<h3 class="anchored" data-anchor-id="risk_return_ratio">risk_return_ratio</h3>
<blockquote class="blockquote">
<pre><code> risk_return_ratio (returns, prepare_returns=True)</code></pre>
</blockquote>
<p>Calculates the return / risk ratio (sharpe ratio without factoring in the risk-free rate)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>returns <span class="op">=</span> _utils.download_returns(<span class="st">'SPY'</span>, <span class="st">'5y'</span>)</span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a>risk_return_ratio(returns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0.033793529561903915</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L805" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="drawdown_details" class="level3">
<h3 class="anchored" data-anchor-id="drawdown_details">drawdown_details</h3>
<blockquote class="blockquote">
<pre><code> drawdown_details (drawdown)</code></pre>
</blockquote>
<p>Calculates drawdown details, including start/end/valley dates, duration, max drawdown and max dd for 99% of the dd period for every drawdown period</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>returns <span class="op">=</span> _utils.download_returns(<span class="st">'SPY'</span>, <span class="st">'5y'</span>)</span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>drawdown <span class="op">=</span> to_drawdown_series(returns)</span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a>drawdown_details(drawdown).tail(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>start</th>
      <th>valley</th>
      <th>end</th>
      <th>days</th>
      <th>max drawdown</th>
      <th>99% max drawdown</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>86</th>
      <td>2021-09-03</td>
      <td>2021-10-04</td>
      <td>2021-10-20</td>
      <td>47</td>
      <td>-5.114137</td>
      <td>-5.003459</td>
    </tr>
    <tr>
      <th>87</th>
      <td>2021-10-22</td>
      <td>2021-10-22</td>
      <td>2021-10-25</td>
      <td>3</td>
      <td>-0.103615</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>88</th>
      <td>2021-10-27</td>
      <td>2021-10-27</td>
      <td>2021-10-28</td>
      <td>1</td>
      <td>-0.443010</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>89</th>
      <td>2021-11-09</td>
      <td>2021-11-10</td>
      <td>2021-11-16</td>
      <td>7</td>
      <td>-1.132363</td>
      <td>-1.100381</td>
    </tr>
    <tr>
      <th>90</th>
      <td>2021-11-17</td>
      <td>2021-11-17</td>
      <td>2021-11-18</td>
      <td>1</td>
      <td>-0.242927</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>91</th>
      <td>2021-11-19</td>
      <td>2021-12-01</td>
      <td>2021-12-10</td>
      <td>21</td>
      <td>-4.093850</td>
      <td>-3.472205</td>
    </tr>
    <tr>
      <th>92</th>
      <td>2021-12-13</td>
      <td>2021-12-20</td>
      <td>2021-12-23</td>
      <td>10</td>
      <td>-3.008357</td>
      <td>-1.965921</td>
    </tr>
    <tr>
      <th>93</th>
      <td>2021-12-28</td>
      <td>2021-12-28</td>
      <td>2021-12-29</td>
      <td>1</td>
      <td>-0.081728</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>94</th>
      <td>2021-12-30</td>
      <td>2021-12-31</td>
      <td>2022-01-03</td>
      <td>4</td>
      <td>-0.527776</td>
      <td>-0.276447</td>
    </tr>
    <tr>
      <th>95</th>
      <td>2022-01-04</td>
      <td>2022-09-29</td>
      <td>2022-09-29</td>
      <td>268</td>
      <td>-23.177148</td>
      <td>-23.009976</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L821" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="kelly_criterion" class="level3">
<h3 class="anchored" data-anchor-id="kelly_criterion">kelly_criterion</h3>
<blockquote class="blockquote">
<pre><code> kelly_criterion (returns, prepare_returns=False)</code></pre>
</blockquote>
<p>Calculates the recommended maximum amount of capital that should be allocated to the given strategy, based on the Kelly Criterion (http://en.wikipedia.org/wiki/Kelly_criterion)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>returns <span class="op">=</span> _utils.download_returns(<span class="st">'SPY'</span>, <span class="st">'5y'</span>)</span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a>kelly_criterion(returns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0.05533682629177291</code></pre>
</div>
</div>
</section>
<section id="comparing-against-a-benchmark" class="level2">
<h2 class="anchored" data-anchor-id="comparing-against-a-benchmark">Comparing against a benchmark</h2>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L836" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="r_squared" class="level3">
<h3 class="anchored" data-anchor-id="r_squared">r_squared</h3>
<blockquote class="blockquote">
<pre><code> r_squared (returns, benchmark, prepare_returns=True)</code></pre>
</blockquote>
<p>Measures the straight line fit of the equity curve</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a>SPY <span class="op">=</span> _utils.download_prices(<span class="st">'SPY'</span>, <span class="st">'5y'</span>)</span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a>r_squared(SPY, <span class="st">'QQQ'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0.8657597594693889</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L846" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="r2" class="level3">
<h3 class="anchored" data-anchor-id="r2">r2</h3>
<blockquote class="blockquote">
<pre><code> r2 (returns, benchmark)</code></pre>
</blockquote>
<p>Shorthand for r_squared()</p>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L851" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="information_ratio" class="level3">
<h3 class="anchored" data-anchor-id="information_ratio">information_ratio</h3>
<blockquote class="blockquote">
<pre><code> information_ratio (returns, benchmark, prepare_returns=True)</code></pre>
</blockquote>
<p>Calculates the information ratio (basically the risk return ratio of the net profits)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a>SPY <span class="op">=</span> _utils.download_prices(<span class="st">'SPY'</span>, <span class="st">'5y'</span>)</span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a>information_ratio(SPY, <span class="st">'QQQ'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>-0.034145732893584566</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L863" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="greeks" class="level3">
<h3 class="anchored" data-anchor-id="greeks">greeks</h3>
<blockquote class="blockquote">
<pre><code> greeks (returns, benchmark, periods=252.0, prepare_returns=True)</code></pre>
</blockquote>
<p>Calculates alpha and beta of the portfolio</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a>SPY <span class="op">=</span> _utils.download_prices(<span class="st">'SPY'</span>, <span class="st">'5y'</span>)</span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a>greeks(SPY, <span class="st">'QQQ'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>beta     0.766525
alpha   -0.014009
dtype: float64</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L887" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="rolling_greeks" class="level3">
<h3 class="anchored" data-anchor-id="rolling_greeks">rolling_greeks</h3>
<blockquote class="blockquote">
<pre><code> rolling_greeks (returns, benchmark, periods=252, prepare_returns=True)</code></pre>
</blockquote>
<p>Calculates rolling alpha and beta of the portfolio</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a>SPY <span class="op">=</span> _utils.download_prices(<span class="st">'SPY'</span>, <span class="st">'5y'</span>)</span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a>rolling_greeks(SPY, <span class="st">'QQQ'</span>).tail(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>beta</th>
      <th>alpha</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2022-09-16</th>
      <td>0.711193</td>
      <td>-0.000020</td>
    </tr>
    <tr>
      <th>2022-09-19</th>
      <td>0.711200</td>
      <td>-0.000020</td>
    </tr>
    <tr>
      <th>2022-09-20</th>
      <td>0.711199</td>
      <td>-0.000020</td>
    </tr>
    <tr>
      <th>2022-09-21</th>
      <td>0.712228</td>
      <td>-0.000020</td>
    </tr>
    <tr>
      <th>2022-09-22</th>
      <td>0.711855</td>
      <td>-0.000020</td>
    </tr>
    <tr>
      <th>2022-09-23</th>
      <td>0.712161</td>
      <td>-0.000020</td>
    </tr>
    <tr>
      <th>2022-09-26</th>
      <td>0.712399</td>
      <td>-0.000020</td>
    </tr>
    <tr>
      <th>2022-09-27</th>
      <td>0.712574</td>
      <td>-0.000020</td>
    </tr>
    <tr>
      <th>2022-09-28</th>
      <td>0.713869</td>
      <td>-0.000021</td>
    </tr>
    <tr>
      <th>2022-09-29</th>
      <td>0.714026</td>
      <td>-0.000021</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L909" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="treynor_ratio" class="level3">
<h3 class="anchored" data-anchor-id="treynor_ratio">treynor_ratio</h3>
<blockquote class="blockquote">
<pre><code> treynor_ratio (returns, benchmark, periods=252.0, rf=0.0,
                prepare_returns=True)</code></pre>
</blockquote>
<p>Calculates the Treynor ratio Args: * returns (Series, DataFrame): Input return series * benchmatk (String, Series, DataFrame): Benchmark to compare beta to * periods (int): Freq. of returns (252/365 for daily, 12 for monthly)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a>SPY <span class="op">=</span> _utils.download_prices(<span class="st">'SPY'</span>, <span class="st">'5y'</span>)</span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a>treynor_ratio(SPY, <span class="st">'QQQ'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0.7394830437816903</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L928" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="compare" class="level3">
<h3 class="anchored" data-anchor-id="compare">compare</h3>
<blockquote class="blockquote">
<pre><code> compare (returns, benchmark, aggregate=None, compounded=True,
          round_vals=None, prepare_returns=True)</code></pre>
</blockquote>
<p>Compare returns to benchmark on a day/week/month/quarter/year basis</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a>SPY <span class="op">=</span> _utils.download_returns(<span class="st">'SPY'</span>, <span class="st">'5y'</span>)</span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a>compare(SPY, <span class="st">'QQQ'</span>, aggregate <span class="op">=</span> <span class="st">'M'</span>).tail(<span class="dv">12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Returns</th>
      <th>Benchmark</th>
      <th>Multiplier</th>
      <th>Won</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>(2021, 10)</th>
      <td>7.016350</td>
      <td>7.864013</td>
      <td>0.892210</td>
      <td>-</td>
    </tr>
    <tr>
      <th>(2021, 11)</th>
      <td>-0.803480</td>
      <td>1.996842</td>
      <td>-0.402376</td>
      <td>-</td>
    </tr>
    <tr>
      <th>(2021, 12)</th>
      <td>4.624778</td>
      <td>1.152342</td>
      <td>4.013372</td>
      <td>+</td>
    </tr>
    <tr>
      <th>(2022, 1)</th>
      <td>-5.274126</td>
      <td>-8.747021</td>
      <td>0.602963</td>
      <td>+</td>
    </tr>
    <tr>
      <th>(2022, 2)</th>
      <td>-2.951699</td>
      <td>-4.475968</td>
      <td>0.659455</td>
      <td>+</td>
    </tr>
    <tr>
      <th>(2022, 3)</th>
      <td>3.759043</td>
      <td>4.667878</td>
      <td>0.805300</td>
      <td>-</td>
    </tr>
    <tr>
      <th>(2022, 4)</th>
      <td>-8.776911</td>
      <td>-13.595739</td>
      <td>0.645563</td>
      <td>+</td>
    </tr>
    <tr>
      <th>(2022, 5)</th>
      <td>0.225728</td>
      <td>-1.586593</td>
      <td>-0.142272</td>
      <td>+</td>
    </tr>
    <tr>
      <th>(2022, 6)</th>
      <td>-8.246043</td>
      <td>-8.907885</td>
      <td>0.925702</td>
      <td>+</td>
    </tr>
    <tr>
      <th>(2022, 7)</th>
      <td>9.208745</td>
      <td>12.551730</td>
      <td>0.733663</td>
      <td>-</td>
    </tr>
    <tr>
      <th>(2022, 8)</th>
      <td>-4.080199</td>
      <td>-5.132186</td>
      <td>0.795022</td>
      <td>+</td>
    </tr>
    <tr>
      <th>(2022, 9)</th>
      <td>-7.819145</td>
      <td>-8.992359</td>
      <td>0.869532</td>
      <td>+</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Note that these returns are already formatted in percentage terms</p>
<hr>
<p><a href="https://github.com/KGrewal1/hypersheets/blob/main/hypersheets/stats.py#L954" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="monthly_returns" class="level3">
<h3 class="anchored" data-anchor-id="monthly_returns">monthly_returns</h3>
<blockquote class="blockquote">
<pre><code> monthly_returns (returns, eoy=True, compounded=True,
                  prepare_returns=True)</code></pre>
</blockquote>
<p>Calculates monthly returns</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a>SPY <span class="op">=</span> _utils.download_prices(<span class="st">'SPY'</span>, <span class="st">'5Y'</span>)</span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a>monthly_returns(SPY)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>JAN</th>
      <th>FEB</th>
      <th>MAR</th>
      <th>APR</th>
      <th>MAY</th>
      <th>JUN</th>
      <th>JUL</th>
      <th>AUG</th>
      <th>SEP</th>
      <th>OCT</th>
      <th>NOV</th>
      <th>DEC</th>
      <th>EOY</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2017</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.019142</td>
      <td>0.030566</td>
      <td>0.012128</td>
      <td>0.063031</td>
    </tr>
    <tr>
      <th>2018</th>
      <td>0.056359</td>
      <td>-0.036360</td>
      <td>-0.027411</td>
      <td>0.005168</td>
      <td>0.024309</td>
      <td>0.005751</td>
      <td>0.037047</td>
      <td>0.031920</td>
      <td>0.005945</td>
      <td>-0.069104</td>
      <td>0.018549</td>
      <td>-0.088049</td>
      <td>-0.045690</td>
    </tr>
    <tr>
      <th>2019</th>
      <td>0.080066</td>
      <td>0.032416</td>
      <td>0.018100</td>
      <td>0.040852</td>
      <td>-0.063771</td>
      <td>0.069586</td>
      <td>0.015119</td>
      <td>-0.016743</td>
      <td>0.019458</td>
      <td>0.022105</td>
      <td>0.036198</td>
      <td>0.029055</td>
      <td>0.312239</td>
    </tr>
    <tr>
      <th>2020</th>
      <td>-0.000404</td>
      <td>-0.079166</td>
      <td>-0.124871</td>
      <td>0.126983</td>
      <td>0.047645</td>
      <td>0.017735</td>
      <td>0.058892</td>
      <td>0.069797</td>
      <td>-0.037444</td>
      <td>-0.024933</td>
      <td>0.108777</td>
      <td>0.037049</td>
      <td>0.183316</td>
    </tr>
    <tr>
      <th>2021</th>
      <td>-0.010191</td>
      <td>0.027805</td>
      <td>0.045399</td>
      <td>0.052911</td>
      <td>0.006566</td>
      <td>0.022427</td>
      <td>0.024413</td>
      <td>0.029760</td>
      <td>-0.046605</td>
      <td>0.070163</td>
      <td>-0.008035</td>
      <td>0.046248</td>
      <td>0.287287</td>
    </tr>
    <tr>
      <th>2022</th>
      <td>-0.052741</td>
      <td>-0.029517</td>
      <td>0.037590</td>
      <td>-0.087769</td>
      <td>0.002257</td>
      <td>-0.082460</td>
      <td>0.092087</td>
      <td>-0.040802</td>
      <td>-0.078191</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>-0.227324</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>